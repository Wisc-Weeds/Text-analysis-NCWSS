---
title: "NCWSS-abstract"
author: "Maxwel Coura Oliveira"
date: "10/8/2020"
output: html_document
---


```{r include=FALSE}
library(ggwordcloud)
library(textreadr)
library(readr)
library(rvest)
library(downloader)
library(tidyverse)
library(tidytext)
library(pdftools)
library(dplyr)
library(wordcloud)
library(topicmodels)
library(xml2)
library(DescTools)
library(tm)
library(stringr)
library(rcorpora)
library(genius)
```


```{r}
# this code section will take long (~3 min) to run. 
clean_corpus <- function(corpus){
  corpus <- tm_map(corpus, removePunctuation) # remove punctuation
  corpus <- tm_map(corpus, content_transformer(tolower)) # remove punctuation
  corpus <- tm_map(corpus, removeNumbers) # remove numbers
  corpus
}
```


# 2001

```{r}
pdf_01 <- pdf_text("nc2001.pdf") %>% 
  strsplit(split = "\n")



title_01 <- pdf_01[5:211] 



titledm_01 <- data.frame() # as data frame

for (i in 1:length(title_01)) {
  print(i)
  titlelines <- data.frame(names = title_01[[i]])
  titledm_01 <- bind_rows(titledm_01, titlelines)
} 




titledm_01$names <- gsub("2,4-D" , "twofourd" , titledm_01$names)




title_tokens_01 <- titledm_01 %>%
  unnest_tokens(words, names)



authors_01 <- read_html("http://ncwss.org/proceed/2001/indexes/author.htm") %>% 
  html_nodes(xpath = "/html") %>%
  html_text() 
authors_01 <- c(authors_01)
authors_01 <- data_frame(authors_01)
#tokerization
authors_tokens_01 <- authors_01 %>%
  unnest_tokens(words, authors_01) %>% 
  filter(words != "weed" & words != "palmer")




#title_tokens_01 <- anti_join(title_tokens_01, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_01 <- anti_join(title_tokens_01, stopwords_tokens, by = "words") 
title_tokens_01 <- anti_join(title_tokens_01, authors_tokens_01, by = "words") 




title_source_01 <- VectorSource(title_tokens_01$words)
title_corpus_01 <- VCorpus(title_source_01)
title_corpus_01 <- clean_corpus(title_corpus_01)




title_dtm_01 <- TermDocumentMatrix(title_corpus_01)
title_matrix_01 <- as.matrix(title_dtm_01)
title_v_01 <- sort(rowSums(title_matrix_01), decreasing=TRUE)
title_dt_01 <- data.frame(word = names(title_v_01),freq=title_v_01)




title_dt_01$word <- gsub("twofourd" , "2,4-D" , title_dt_01$word)




words01 <- title_dt_01  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2001") %>% 
  anti_join(stop_wssaprogram_words) 
```



```{r eval=FALSE} 
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_01$word, freq = title_dt_01$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```



# 2002

```{r}
pdf_02 <- pdf_text("nc2002.pdf") %>% 
  strsplit(split = "\n")
```

```{r}
title_02 <- pdf_02[5:211] 
```

```{r warning=FALSE, include=FALSE}
titledm_02 <- data.frame() # as data frame

for (i in 1:length(title_02)) {
  print(i)
  titlelines <- data.frame(names = title_02[[i]])
  titledm_02 <- bind_rows(titledm_02, titlelines)
} 
```

```{r}
titledm_02$names <- gsub("2,4-D" , "twofourd" , titledm_02$names)
```

```{r}
title_tokens_02 <- titledm_02 %>%
  unnest_tokens(words, names)
```


```{r eval=FALSE, include=FALSE}
authors_02 <- read_html("http://ncwss.org/proceed/2002/Proc2002/abstracts/author2.htm") %>% 
  html_nodes(xpath = "/html/body/p[.]") %>%
  html_text() 
authors_02 <- c(authors_02)
authors_02 <- data_frame(authors_02)
#tokerization
authors_tokens_02 <- authors_02 %>%
  unnest_tokens(words, authors_02) %>% 
  filter(words != "weed")
```


```{r }
#title_tokens_02 <- anti_join(title_tokens_02, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_02 <- anti_join(title_tokens_02, stopwords_tokens, by = "words") 
title_tokens_02 <- anti_join(title_tokens_02, authors_tokens_02, by = "words") 
```


```{r}
title_source_02 <- VectorSource(title_tokens_02$words)
title_corpus_02 <- VCorpus(title_source_02)
title_corpus_02 <- clean_corpus(title_corpus_02)
```

```{r}
title_dtm_02 <- TermDocumentMatrix(title_corpus_02)
title_matrix_02 <- as.matrix(title_dtm_02)
title_v_02 <- sort(rowSums(title_matrix_02), decreasing=TRUE)
title_dt_02 <- data.frame(word = names(title_v_02),freq=title_v_02)
```

```{r}
title_dt_02$word <- gsub("twofourd" , "2,4-D" , title_dt_02$word)
```

```{r}
words02 <- title_dt_02  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2002") 
```






```{r eval=FALSE}  
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_02$word, freq = title_dt_02$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```






# 2003

```{r}
pdf_03 <- pdf_text("nc2003.pdf") %>% 
  strsplit(split = "\n")



title_03 <- pdf_03[1:205] 



titledm_03 <- data.frame() # as data frame

for (i in 1:length(title_03)) {
  print(i)
  titlelines <- data.frame(names = title_03[[i]])
  titledm_03 <- bind_rows(titledm_03, titlelines)
} 



titledm_03$names <- gsub("2,4-D" , "twofourd" , titledm_03$names)




title_tokens_03 <- titledm_03 %>%
  unnest_tokens(words, names)




authors_03 <- read_html("http://ncwss.org/proceed/2003/Proc03/abstracts/author%20index.htm") %>% 
  html_nodes(xpath = "/html/body/ilayer/table[.]") %>%
  html_text() 
authors_03 <- c(authors_03)
authors_03 <- data_frame(authors_03)
#tokerization
authors_tokens_03 <- authors_03 %>%
  unnest_tokens(words, authors_03)




#title_tokens_03 <- anti_join(title_tokens_03, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_03 <- anti_join(title_tokens_03, stopwords_tokens, by = "words") 
title_tokens_03 <- anti_join(title_tokens_03, authors_tokens_03, by = "words") 




title_source_03 <- VectorSource(title_tokens_03$words)
title_corpus_03 <- VCorpus(title_source_03)
title_corpus_03 <- clean_corpus(title_corpus_03)




title_dtm_03 <- TermDocumentMatrix(title_corpus_03)
title_matrix_03 <- as.matrix(title_dtm_03)
title_v_03 <- sort(rowSums(title_matrix_03), decreasing=TRUE)
title_dt_03 <- data.frame(word = names(title_v_03),freq=title_v_03)



title_dt_03$word <- gsub("twofourd" , "2,4-D" , title_dt_03$word)



words03 <- title_dt_03  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2003") %>% 
  anti_join(stop_wssaprogram_words) 
```



```{r message=FALSE, warning=FALSE, eval=FALSE} 
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_03$word, freq = title_dt_03$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```







# 2004

```{r}
pdf_04 <- pdf_text("nc2004.pdf") %>% 
  strsplit(split = "\n")



title_04 <- pdf_04[3:188] 



titledm_04 <- data.frame() # as data frame

for (i in 1:length(title_04)) {
  print(i)
  titlelines <- data.frame(names = title_04[[i]])
  titledm_04 <- bind_rows(titledm_04, titlelines)
} 




titledm_04$names <- gsub("2,4-D" , "twofourd" , titledm_04$names)



title_tokens_04 <- titledm_04 %>%
  unnest_tokens(words, names)




authors_04 <- read_html("http://ncwss.org/proceed/2004/proc04/abstracts/authors.htm") %>% 
  html_nodes(xpath = "//table[2]") %>%
  html_text() 
authors_04 <- c(authors_04)
authors_04 <- data_frame(authors_04)
#tokerization
authors_tokens_04 <- authors_04 %>%
  unnest_tokens(words, authors_04)




#title_tokens_04 <- anti_join(title_tokens_04, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_04 <- anti_join(title_tokens_04, stopwords_tokens, by = "words") 
title_tokens_04 <- anti_join(title_tokens_04, authors_tokens_04, by = "words") 




title_source_04 <- VectorSource(title_tokens_04$words)
title_corpus_04 <- VCorpus(title_source_04)
title_corpus_04 <- clean_corpus(title_corpus_04)




title_dtm_04 <- TermDocumentMatrix(title_corpus_04)
title_matrix_04 <- as.matrix(title_dtm_04)
title_v_04 <- sort(rowSums(title_matrix_04), decreasing=TRUE)
title_dt_04 <- data.frame(word = names(title_v_04),freq=title_v_04)



title_dt_04$word <- gsub("twofourd" , "2,4-D" , title_dt_04$word)



words04 <- title_dt_04  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2004")  %>% 
  anti_join(stop_wssaprogram_words) 
```


```{r warning = FALSE, eval=FALSE} 
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_04$word, freq = title_dt_04$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```










# 2005

```{r}
pdf_05 <- pdf_text("nc2005.pdf") %>% 
  strsplit(split = "\n")


title_05 <- pdf_05[1:229] 



titledm_05 <- data.frame() # as data frame

for (i in 1:length(title_05)) {
  print(i)
  titlelines <- data.frame(names = title_05[[i]])
  titledm_05 <- bind_rows(titledm_05, titlelines)
} 



titledm_05$names <- gsub("2,4-D" , "twofourd" , titledm_05$names)




title_tokens_05 <- titledm_05 %>%
  unnest_tokens(words, names)




authors_05 <- read_html("http://ncwss.org/proceed/2005/proc05/abstracts/author.htm") %>% 
  html_nodes(xpath = "//table[2]") %>%
  html_text() 
authors_05 <- c(authors_05)
authors_05 <- data_frame(authors_05)
#tokerization
authors_tokens_05 <- authors_05 %>%
  unnest_tokens(words, authors_05)




#title_tokens_05 <- anti_join(title_tokens_05, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_05 <- anti_join(title_tokens_05, stopwords_tokens, by = "words") 
title_tokens_05 <- anti_join(title_tokens_05, authors_tokens_05, by = "words") 




title_source_05 <- VectorSource(title_tokens_05$words)
title_corpus_05 <- VCorpus(title_source_05)
title_corpus_05 <- clean_corpus(title_corpus_05)





title_dtm_05 <- TermDocumentMatrix(title_corpus_05)
title_matrix_05 <- as.matrix(title_dtm_05)
title_v_05 <- sort(rowSums(title_matrix_05), decreasing=TRUE)
title_dt_05 <- data.frame(word = names(title_v_05),freq=title_v_05)



title_dt_05$word <- gsub("twofourd" , "2,4-D" , title_dt_05$word)



words05 <- title_dt_05  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2005") %>% 
  anti_join(stop_wssaprogram_words) 
```


```{r eval=FALSE} 
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_05$word, freq = title_dt_05$freq, min.freq=1, scale=c(5,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```




# 2006


```{r}
pdf_06 <- pdf_text("nc2006.pdf") %>% 
  strsplit(split = "\n")




title_06 <- pdf_06[1:216] 




titledm_06 <- data.frame() # as data frame

for (i in 1:length(title_06)) {
  print(i)
  titlelines_06 <- data.frame(names = title_06[[i]])
  titledm_06 <- bind_rows(titledm_06, titlelines_06)
} 



titledm_06$names <- gsub("2,4-D" , "twofourd" , titledm_06$names)




title_tokens_06 <- titledm_06 %>%
  unnest_tokens(words, names)



authors_06 <- read_html("http://ncwss.org/proceed/2006/authorindex.html") %>% 
  html_nodes(xpath = "/html/body") %>%
  html_text() 
authors_06 <- c(authors_06)
authors_06 <- data_frame(authors_06)
#tokerization
authors_tokens_06 <- authors_06 %>%
  unnest_tokens(words, authors_06) %>% 
  filter(words != "weed")


title_tokens_06 <- anti_join(title_tokens_06, authors_tokens_06, by = "words")


#title_tokens_06 <- anti_join(title_tokens_06, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_06 <- anti_join(title_tokens_06, stopwords_tokens, by = "words") 
title_tokens_06 <- anti_join(title_tokens_06, authors_tokens_06, by = "words") 




title_source_06 <- VectorSource(title_tokens_06$words)
title_corpus_06 <- VCorpus(title_source_06)
title_corpus_06 <- clean_corpus(title_corpus_06)



title_dtm_06 <- TermDocumentMatrix(title_corpus_06)
title_matrix_06 <- as.matrix(title_dtm_06)
title_v_06 <- sort(rowSums(title_matrix_06), decreasing=TRUE)
title_dt_06 <- data.frame(word = names(title_v_06),freq=title_v_06)


title_dt_06$word <- gsub("twofourd" , "2,4-D" , title_dt_06$word)



words06 <- title_dt_06  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2006") %>% 
  anti_join(stop_wssaprogram_words) 
```


```{r  eval=FALSE}  
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_06$word, freq = title_dt_06$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```




# 2007

```{r}
pdf_07 <- pdf_text("nc2007.pdf") %>% 
  strsplit(split = "\n")


title_07 <- pdf_07[6:248] 



titledm_07 <- data.frame() # as data frame

for (i in 1:length(title_07)) {
  print(i)
  titlelines_07 <- data.frame(names = title_07[[i]])
  titledm_07 <- bind_rows(titledm_07, titlelines_07)
} 



titledm_07$names <- gsub("2,4-D" , "twofourd" , titledm_07$names)



title_tokens_07 <- titledm_07 %>%
  unnest_tokens(words, names)




authors_07 <- read_html("http://ncwss.org/proceed/2007/authorindex.html") %>% 
  html_nodes(xpath = "//table[.]") %>%
  html_text() 
authors_07 <- c(authors_07)
authors_07 <- data_frame(authors_07)
#tokerization
authors_tokens_07 <- authors_07 %>%
  unnest_tokens(words, authors_07)



title_tokens_07 <- anti_join(title_tokens_07, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_07 <- anti_join(title_tokens_07, stopwords_tokens, by = "words") 
title_tokens_07 <- anti_join(title_tokens_07, authors_tokens_07, by = "words") 



title_source_07 <- VectorSource(title_tokens_07$words)
title_corpus_07 <- VCorpus(title_source_07)
title_corpus_07 <- clean_corpus(title_corpus_07)



title_dtm_07 <- TermDocumentMatrix(title_corpus_07)
title_matrix_07 <- as.matrix(title_dtm_07)
title_v_07 <- sort(rowSums(title_matrix_07), decreasing=TRUE)
title_dt_07 <- data.frame(word = names(title_v_07),freq=title_v_07)



title_dt_07$word <- gsub("twofourd" , "2,4-D" , title_dt_07$word)


words07 <- title_dt_07  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2007") %>% 
  anti_join(stop_wssaprogram_words) 
```


```{r  eval=FALSE}  
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_07$word, freq = title_dt_07$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```









# 2008

```{r}
pdf_08 <- pdf_text("nc2008.pdf") %>% 
  strsplit(split = "\n")



title_08 <- pdf_08[1:215] 



titledm_08 <- data.frame() # as data frame

for (i in 1:length(title_08)) {
  print(i)
  titlelines_08 <- data.frame(names = title_08[[i]])
  titledm_08 <- bind_rows(titledm_08, titlelines_08)
} 



titledm_08$names <- gsub("2,4-D" , "twofourd" , titledm_08$names)



title_tokens_08 <- titledm_08 %>%
  unnest_tokens(words, names)



# Authors 2008
authors_08 <- read_html("http://ncwss.org/proceed/2008/authorindex.html") %>% 
  html_nodes(xpath = "//table[.]") %>%
  html_text() 
authors_08 <- c(authors_08)
authors_08 <- data_frame(authors_08)
#tokerization
authors_tokens_08 <- authors_08 %>%
  unnest_tokens(words, authors_08)



#title_tokens_08 <- anti_join(title_tokens_08, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_08 <- anti_join(title_tokens_08, stopwords_tokens, by = "words") 
title_tokens_08 <- anti_join(title_tokens_08, authors_tokens_08, by = "words") 


title_source_08 <- VectorSource(title_tokens_08$words)
title_corpus_08 <- VCorpus(title_source_08)
title_corpus_08 <- clean_corpus(title_corpus_08)


title_dtm_08 <- TermDocumentMatrix(title_corpus_08)
title_matrix_08 <- as.matrix(title_dtm_08)
title_v_08 <- sort(rowSums(title_matrix_08), decreasing=TRUE)
title_dt_08 <- data.frame(word = names(title_v_08),freq=title_v_08)


title_dt_08$word <- gsub("twofourd" , "2,4-D" , title_dt_08$word)




words08 <- title_dt_08  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2008") %>% 
  anti_join(stop_wssaprogram_words) 
```


```{r  eval=FALSE}  
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_08$word, freq = title_dt_08$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```




# 2009

```{r}
pdf_09 <- pdf_text("nc2009.pdf") %>% 
  strsplit(split = "\n")



title_09 <- pdf_09[1:165] 



titledm_09 <- data.frame() # as data frame

for (i in 1:length(title_09)) {
  print(i)
  titlelines_09 <- data.frame(names = title_09[[i]])
  titledm_09 <- bind_rows(titledm_09, titlelines_09)
} 



titledm_09$names <- gsub("2,4-D" , "twofourd" , titledm_09$names)



title_tokens_09 <- titledm_09 %>%
  unnest_tokens(words, names)




# Authors 2009
authors_09 <- read_html("http://ncwss.org/proceed/2009/authorindex.html") %>% 
  html_nodes(xpath = "//table[.]") %>%
  html_text() 
authors_09 <- c(authors_09)
authors_09 <- data_frame(authors_09)
#tokerization
authors_tokens_09 <- authors_09 %>%
  unnest_tokens(words, authors_09)




#title_tokens_09 <- anti_join(title_tokens_09, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_09 <- anti_join(title_tokens_09, stopwords_tokens, by = "words") 
title_tokens_09 <- anti_join(title_tokens_09, authors_tokens_09, by = "words") 




title_source_09 <- VectorSource(title_tokens_09$words)
title_corpus_09 <- VCorpus(title_source_09)
title_corpus_09 <- clean_corpus(title_corpus_09)




title_dtm_09 <- TermDocumentMatrix(title_corpus_09)
title_matrix_09 <- as.matrix(title_dtm_09)
title_v_09 <- sort(rowSums(title_matrix_09), decreasing=TRUE)
title_dt_09 <- data.frame(word = names(title_v_09),freq=title_v_09)




title_dt_09$word <- gsub("twofourd" , "2,4-D" , title_dt_09$word)



words09 <- title_dt_09  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2009")  %>% 
  anti_join(stop_wssaprogram_words)
```


```{r  eval=FALSE}  
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_09$word, freq = title_dt_09$freq, min.freq=1, scale=c(4,.1),
          random.order=FALSE, rot.per=0.35, colors=pal)
```






# 2010 - 2019





```{r eval=FALSE, include=FALSE}
nc2010 <- download("http://ncwss.org/wp-content/uploads/2015/03/NCWSS-2010-Proceedings.pdf", "nc2010.pdf", mode = "wb")
nc2011 <- download("http://ncwss.org/wp-content/uploads/2015/03/NCWSS-2011-Proceedings.pdf", "nc2011.pdf", mode = "wb")
nc2012 <- download("http://ncwss.org/wp-content/uploads/2015/03/NCWSS-2012-Proceedings.pdf", "nc2012.pdf", mode = "wb")
nc2013 <- download("http://ncwss.org/wp-content/uploads/2015/03/NCWSS-2013-Proceedings.pdf", "nc2013.pdf", mode = "wb")
nc2014 <- download("http://ncwss.org/wp-content/uploads/2015/03/NCWSS-2014-Proceedings.pdf", "nc2014.pdf", mode = "wb")
nc2015 <- download("http://ncwss.org/wp-content/uploads/2015/03/2015-North-Central-Weed-Science-Society-Proceedings-Final.pdf", "nc2015.pdf", mode = "wb")
nc2016 <- download("http://ncwss.org/wp-content/uploads/2016-North-Central-Weed-Science-Society-Proceedings.pdf", "nc2016.pdf", mode = "wb")
nc2017 <- download("https://ncwss.org/wp-content/uploads/2017-North-Central-Weed-Science-Society-Proceedings-w_attendees.pdf", "nc2017.pdf", mode = "wb")
nc2018 <- download("https://ncwss.org/wp-content/uploads/NCWSS-Annual-Meeting-Proceedings-2018.pdf", "nc2018.pdf", mode = "wb")
nc2019 <- download("https://ncwss.org/wp-content/uploads/NCWSS-2019-Proceedings-FINAL.pdf", "nc2019.pdf", mode = "wb")
```

# 2010

```{r}
pdf_10 <- pdf_text("nc2010.pdf") %>% 
  strsplit(split = "\n")



title_10 <- pdf_10[14:84] 


titledm_10 <- data.frame() # as data frame

for (i in 1:length(title_10)) {
  print(i)
  titlelines_10 <- data.frame(names = title_10[[i]])
  titledm_10 <- bind_rows(titledm_10, titlelines_10)
} 



titledm_10$names <- gsub("2,4-D" , "twofourd" , titledm_10$names)



title_tokens_10 <- titledm_10 %>%
  unnest_tokens(words, names)




authors_10 <- pdf_10[85:91]

authorsdm_10 <- data.frame()

for (i in 1:length(authors_10)) {
  print(i)
  authorslines_10 <- data.frame(names = authors_10[[i]])
  authorsdm_10 <- bind_rows(authorsdm_10, authorslines_10)
} 

#tokerization
authors_tokens_10 <- authorsdm_10 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")



titles_tokens_10 <- anti_join(title_tokens_10, authors_tokens_10, by = "words")




rm_author_10 <- c(1:12) 
rm_authors_number_10 <-c()
for (i in 1:length(rm_author_10)) {
  print(i)
  rm_authors_numbers_10 <- c(paste0(authors_tokens_10$words, i))
  rm_authors_number_10 <- c(rm_authors_number_10, rm_authors_numbers_10)
}



rm_authors_10 <- data.frame(rm_authors_number_10) 
rm_authors_10 <- rename(rm_authors_10, words = rm_authors_number_10) 
rm_authors_10$words <- as.character(rm_authors_10$words)



title_tokens_10 <- anti_join(title_tokens_10, rm_authors_10, by = "words") 
#title_tokens_10 <- anti_join(title_tokens_10, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_10 <- anti_join(title_tokens_10, stopwords_tokens, by = "words") 
title_tokens_10 <- anti_join(title_tokens_10, authors_tokens_10, by = "words") 




title_source_10 <- VectorSource(title_tokens_10$words)
title_corpus_10 <- VCorpus(title_source_10)
title_corpus_10 <- clean_corpus(title_corpus_10)



title_dtm_10 <- TermDocumentMatrix(title_corpus_10)
title_matrix_10 <- as.matrix(title_dtm_10)
title_v_10 <- sort(rowSums(title_matrix_10), decreasing=TRUE)
title_dt_10 <- data.frame(word = names(title_v_10),freq=title_v_10)



title_dt_10$word <- gsub("twofourd" , "2,4-D" , title_dt_10$word)



words10 <- title_dt_10  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2010") %>% 
  anti_join(stop_wssaprogram_words)
```


```{r eval=FALSE, include=FALSE}   
# need to stop footnotes' word

pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_10$word, freq = title_dt_10$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```






# 2011

```{r}
pdf_11 <- pdf_text("nc2011.pdf") %>% 
  strsplit(split = "\n")



title_11 <- pdf_10[24:151] 



titledm_11 <- data.frame() # as data frame

for (i in 1:length(title_11)) {
  print(i)
  titlelines_11 <- data.frame(names = title_11[[i]])
  titledm_11 <- bind_rows(titledm_11, titlelines_11)
} 



titledm_11$names <- gsub("2,4-D" , "twofourd" , titledm_11$names)



title_tokens_11 <- titledm_11 %>%
  unnest_tokens(words, names)




authors_11 <- pdf_11[152:157]

authorsdm_11 <- data.frame()

for (i in 1:length(authors_11)) {
  print(i)
  authorslines_11 <- data.frame(names = authors_11[[i]])
  authorsdm_11 <- bind_rows(authorsdm_11, authorslines_11)
} 

#tokerization
authors_tokens_11 <- authorsdm_11 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")



titles_tokens_11 <- anti_join(title_tokens_11, authors_tokens_11, by = "words")




rm_author_11 <- c(1:12) 
rm_authors_number_11 <-c()
for (i in 1:length(rm_author_11)) {
  print(i)
  rm_authors_numbers_11 <- c(paste0(authors_tokens_11$words, i))
  rm_authors_number_11 <- c(rm_authors_number_11, rm_authors_numbers_11)
}

rm_authors_11 <- data.frame(rm_authors_number_11) 
rm_authors_11 <- rename(rm_authors_11, words = rm_authors_number_11) 
rm_authors_11$words <- as.character(rm_authors_11$words)




title_tokens_11 <- anti_join(title_tokens_11, rm_authors_11, by = "words") 
#title_tokens_11 <- anti_join(title_tokens_11, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_11 <- anti_join(title_tokens_11, stopwords_tokens, by = "words") 
title_tokens_11 <- anti_join(title_tokens_11, authors_tokens_11, by = "words") 




title_source_11 <- VectorSource(title_tokens_11$words)
title_corpus_11 <- VCorpus(title_source_11)
title_corpus_11 <- clean_corpus(title_corpus_11)



title_dtm_11 <- TermDocumentMatrix(title_corpus_11)
title_matrix_11 <- as.matrix(title_dtm_11)
title_v_11 <- sort(rowSums(title_matrix_11), decreasing=TRUE)
title_dt_11 <- data.frame(word = names(title_v_11),freq=title_v_11)



title_dt_11$word <- gsub("twofourd" , "2,4-D" , title_dt_11$word)



words11 <- title_dt_11  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2011") %>% 
  anti_join(stop_wssaprogram_words)
```



```{r eval=FALSE, include=FALSE}  
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_11$word, freq = title_dt_11$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```



# 2012

```{r}
pdf_12 <- pdf_text("nc2012.pdf") %>% 
  strsplit(split = "\n")


title_12 <- pdf_12[16:145] 




titledm_12 <- data.frame() # as data frame

for (i in 1:length(title_12)) {
  print(i)
  titlelines_12 <- data.frame(names = title_12[[i]])
  titledm_12 <- bind_rows(titledm_12, titlelines_12)
} 



titledm_12$names <- gsub("2,4-D" , "twofourd" , titledm_12$names)



title_tokens_12 <- titledm_12 %>%
  unnest_tokens(words, names)




authors_12 <- pdf_12[101:104]

authorsdm_12 <- data.frame()

for (i in 1:length(authors_12)) {
  print(i)
  authorslines_12 <- data.frame(names = authors_12[[i]])
  authorsdm_12 <- bind_rows(authorsdm_12, authorslines_12)
} 

#tokerization
authors_tokens_12 <- authorsdm_12 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")




titles_tokens_12 <- anti_join(title_tokens_12, authors_tokens_12, by = "words")




rm_author_12 <- c(1:12) 
rm_authors_number_12 <-c()
for (i in 1:length(rm_author_12)) {
  print(i)
  rm_authors_numbers_12 <- c(paste0(authors_tokens_12$words, i))
  rm_authors_number_12 <- c(rm_authors_number_12, rm_authors_numbers_12)
}

rm_authors_12 <- data.frame(rm_authors_number_12) 
rm_authors_12 <- rename(rm_authors_12, words = rm_authors_number_12) 
rm_authors_12$words <- as.character(rm_authors_12$words)




title_tokens_12 <- anti_join(title_tokens_12, rm_authors_12, by = "words") 
#title_tokens_12 <- anti_join(title_tokens_12, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_12 <- anti_join(title_tokens_12, stopwords_tokens, by = "words") 
title_tokens_12 <- anti_join(title_tokens_12, authors_tokens_12, by = "words") 



title_source_12 <- VectorSource(title_tokens_12$words)
title_corpus_12 <- VCorpus(title_source_12)
title_corpus_12 <- clean_corpus(title_corpus_12)


title_dtm_12 <- TermDocumentMatrix(title_corpus_12)
title_matrix_12 <- as.matrix(title_dtm_12)
title_v_12 <- sort(rowSums(title_matrix_12), decreasing=TRUE)
title_dt_12 <- data.frame(word = names(title_v_12),freq=title_v_12)



title_dt_12$word <- gsub("twofourd" , "2,4-D" , title_dt_12$word)




words12 <- title_dt_12  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2012") %>% 
  anti_join(stop_wssaprogram_words)
```

```{r eval=FALSE, include=FALSE}   
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_12$word, freq = title_dt_12$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```

# 2013

```{r}
pdf_13 <- pdf_text("nc2013.pdf") %>% 
  strsplit(split = "\n")



title_13 <- pdf_13[19:117] 


titledm_13 <- data.frame() # as data frame

for (i in 1:length(title_13)) {
  print(i)
  titlelines_13 <- data.frame(names = title_13[[i]])
  titledm_13 <- bind_rows(titledm_13, titlelines_13)
} 



titledm_13$names <- gsub("2,4-D" , "twofourd" , titledm_13$names)




title_tokens_13 <- titledm_13 %>%
  unnest_tokens(words, names)




authors_13 <- pdf_13[122:125]

authorsdm_13 <- data.frame()

for (i in 1:length(authors_13)) {
  print(i)
  authorslines_13 <- data.frame(names = authors_13[[i]])
  authorsdm_13 <- bind_rows(authorsdm_13, authorslines_13)
} 

#tokerization
authors_tokens_13 <- authorsdm_13 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")




titles_tokens_13 <- anti_join(title_tokens_13, authors_tokens_13, by = "words")




rm_author_13 <- c(1:12) 
rm_authors_number_13 <-c()
for (i in 1:length(rm_author_13)) {
  print(i)
  rm_authors_numbers_13 <- c(paste0(authors_tokens_13$words, i))
  rm_authors_number_13 <- c(rm_authors_number_13, rm_authors_numbers_13)
}

rm_authors_13 <- data.frame(rm_authors_number_13) 
rm_authors_13 <- rename(rm_authors_13, words = rm_authors_number_13) 
rm_authors_13$words <- as.character(rm_authors_13$words) 



title_tokens_13 <- anti_join(title_tokens_13, rm_authors_13, by = "words") 
#title_tokens_13 <- anti_join(title_tokens_13, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_13 <- anti_join(title_tokens_13, stopwords_tokens, by = "words") 
title_tokens_13 <- anti_join(title_tokens_13, authors_tokens_13, by = "words") 



title_source_13 <- VectorSource(title_tokens_13$words)
title_corpus_13 <- VCorpus(title_source_13)
title_corpus_13 <- clean_corpus(title_corpus_13)




title_dtm_13 <- TermDocumentMatrix(title_corpus_13)
title_matrix_13 <- as.matrix(title_dtm_13)
title_v_13 <- sort(rowSums(title_matrix_13), decreasing=TRUE)
title_dt_13 <- data.frame(word = names(title_v_13),freq=title_v_13)



title_dt_13$word <- gsub("twofourd" , "2,4-D" , title_dt_13$word)



words13 <- title_dt_13  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2013") %>% 
  anti_join(stop_wssaprogram_words)
```


```{r eval=FALSE, include=FALSE}   
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_13$word, freq = title_dt_13$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```



# 2014

```{r}
pdf_14 <- pdf_text("nc2014.pdf") %>% 
  strsplit(split = "\n")



title_14 <- pdf_14[15:86] 



titledm_14 <- data.frame() # as data frame

for (i in 1:length(title_14)) {
  print(i)
  titlelines_14 <- data.frame(names = title_14 [[i]])
  titledm_14 <- bind_rows(titledm_14, titlelines_14)
} 




titledm_14$names <- gsub("2,4-D" , "twofourd" , titledm_14$names)




title_tokens_14 <- titledm_14 %>%
  unnest_tokens(words, names)




authors_14 <- pdf_14[87:90]

authorsdm_14 <- data.frame()

for (i in 1:length(authors_14)) {
  print(i)
  authorslines_14 <- data.frame(names = authors_14[[i]])
  authorsdm_14 <- bind_rows(authorsdm_14, authorslines_14)
} 

#tokerization
authors_tokens_14 <- authorsdm_14 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")




titles_tokens_14 <- anti_join(title_tokens_14, authors_tokens_14, by = "words")




rm_author_14 <- c(1:12) 
rm_authors_number_14 <-c()
for (i in 1:length(rm_author_14)) {
  print(i)
  rm_authors_numbers_14 <- c(paste0(authors_tokens_14$words, i))
  rm_authors_number_14 <- c(rm_authors_number_14, rm_authors_numbers_14)
}

rm_authors_14 <- data.frame(rm_authors_number_14) 
rm_authors_14 <- rename(rm_authors_14, words = rm_authors_number_14) 
rm_authors_14$words <- as.character(rm_authors_14$words)




title_tokens_14 <- anti_join(title_tokens_14, rm_authors_14, by = "words") 
#title_tokens_14 <- anti_join(title_tokens_14, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_14 <- anti_join(title_tokens_14, stopwords_tokens, by = "words") 
title_tokens_14 <- anti_join(title_tokens_14, authors_tokens_14, by = "words") 




title_source_14 <- VectorSource(title_tokens_14$words)
title_corpus_14 <- VCorpus(title_source_14)
title_corpus_14 <- clean_corpus(title_corpus_14)




title_dtm_14 <- TermDocumentMatrix(title_corpus_14)
title_matrix_14 <- as.matrix(title_dtm_14)
title_v_14 <- sort(rowSums(title_matrix_14), decreasing=TRUE)
title_dt_14 <- data.frame(word = names(title_v_14),freq=title_v_14)




title_dt_14$word <- gsub("twofourd" , "2,4-D" , title_dt_14$word)



words14 <- title_dt_14  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2014") %>% 
  anti_join(stop_wssaprogram_words)
```


```{r eval=FALSE, include=FALSE}   
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_14$word, freq = title_dt_14$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```



# 2015

```{r}
pdf_15 <- pdf_text("nc2015.pdf") %>% 
  strsplit(split = "\n")



title_15 <- pdf_15[18:91] # need to check pdf (overlap)



titledm_15 <- data.frame() # as data frame

for (i in 1:length(title_15)) {
  print(i)
  titlelines_15 <- data.frame(names = title_15[[i]])
  titledm_15 <- bind_rows(titledm_15, titlelines_15)
} 




titledm_15$names <- gsub("2,4-D" , "twofourd" , titledm_15$names)



title_tokens_15 <- titledm_15 %>%
  unnest_tokens(words, names)




authors_15 <- pdf_15[93:98]

authorsdm_15 <- data.frame()

for (i in 1:length(authors_15)) {
  print(i)
  authorslines_15 <- data.frame(names = authors_15[[i]])
  authorsdm_15 <- bind_rows(authorsdm_15, authorslines_15)
} 

#tokerization
authors_tokens_15 <- authorsdm_15 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")



titles_tokens_15 <- anti_join(title_tokens_15, authors_tokens_15, by = "words")




rm_author_15 <- c(1:12) 
rm_authors_number_15 <-c()
for (i in 1:length(rm_author_15)) {
  print(i)
  rm_authors_numbers_15 <- c(paste0(authors_tokens_15$words, i))
  rm_authors_number_15 <- c(rm_authors_number_15, rm_authors_numbers_15)
}

rm_authors_15 <- data.frame(rm_authors_number_15) 
rm_authors_15 <- rename(rm_authors_15, words = rm_authors_number_15) 
rm_authors_15$words <- as.character(rm_authors_15$words)





title_tokens_15 <- anti_join(title_tokens_15, rm_authors_15, by = "words") 
#title_tokens_15 <- anti_join(title_tokens_15, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_15 <- anti_join(title_tokens_15, stopwords_tokens, by = "words") 
title_tokens_15 <- anti_join(title_tokens_15, authors_tokens_15, by = "words") 



title_source_15 <- VectorSource(title_tokens_15$words)
title_corpus_15 <- VCorpus(title_source_15)




title_corpus_15 <- clean_corpus(title_corpus_15)



title_dtm_15 <- TermDocumentMatrix(title_corpus_15)
title_matrix_15 <- as.matrix(title_dtm_15)
title_v_15 <- sort(rowSums(title_matrix_15), decreasing=TRUE)
title_dt_15 <- data.frame(word = names(title_v_15),freq=title_v_15)



title_dt_15$word <- gsub("twofourd" , "2,4-D" , title_dt_15$word)


words15 <- title_dt_15  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2015") %>% 
  anti_join(stop_wssaprogram_words)
```

```{r eval=FALSE, include=FALSE} 
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_15$word, freq = title_dt_15$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```






# 2016

```{r}
pdf_16 <- pdf_text("nc2016.pdf") %>% 
  strsplit(split = "\n")



title_16 <- pdf_16[16:88] # need to check pdf (overlap)



titledm_16 <- data.frame() # as data frame

for (i in 1:length(title_16)) {
  print(i)
  titlelines_16 <- data.frame(names = title_16[[i]])
  titledm_16 <- bind_rows(titledm_16, titlelines_16)
} 




titledm_16$names <- gsub("2,4-D" , "twofourd" , titledm_16$names)


title_tokens_16 <- titledm_16 %>%
  unnest_tokens(words, names)



authors_16 <- pdf_16[90:93]

authorsdm_16 <- data.frame()

for (i in 1:length(authors_16)) {
  print(i)
  authorslines_16 <- data.frame(names = authors_16[[i]])
  authorsdm_16 <- bind_rows(authorsdm_16, authorslines_16)
} 

#tokerization
authors_tokens_16 <- authorsdm_16 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")



titles_tokens_16 <- anti_join(title_tokens_16, authors_tokens_16, by = "words")



rm_author_16 <- c(1:12) 
rm_authors_number_16 <-c()
for (i in 1:length(rm_author_16)) {
  print(i)
  rm_authors_numbers_16 <- c(paste0(authors_tokens_16$words, i))
  rm_authors_number_16 <- c(rm_authors_number_16, rm_authors_numbers_16)
}

rm_authors_16 <- data.frame(rm_authors_number_16) 
rm_authors_16 <- rename(rm_authors_16, words = rm_authors_number_16) 
rm_authors_16$words <- as.character(rm_authors_16$words)



title_tokens_16 <- anti_join(title_tokens_16, rm_authors_16, by = "words") 
#title_tokens_16 <- anti_join(title_tokens_16, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_16 <- anti_join(title_tokens_16, stopwords_tokens, by = "words") 
title_tokens_16 <- anti_join(title_tokens_16, authors_tokens_16, by = "words") 



title_source_16 <- VectorSource(title_tokens_16$words)
title_corpus_16 <- VCorpus(title_source_16)
title_corpus_16 <- clean_corpus(title_corpus_16)



title_dtm_16 <- TermDocumentMatrix(title_corpus_16)
title_matrix_16 <- as.matrix(title_dtm_16)
title_v_16 <- sort(rowSums(title_matrix_16), decreasing=TRUE)
title_dt_16 <- data.frame(word = names(title_v_16),freq=title_v_16)


title_dt_16$word <- gsub("twofourd" , "2,4-D" , title_dt_16$word)


words16 <- title_dt_16  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2016") %>% 
  anti_join(stop_wssaprogram_words)
```



```{r eval=FALSE, include=FALSE}   
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_16$word, freq = title_dt_16$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```



# 2017

```{r}
pdf_17 <- pdf_text("nc2017.pdf") %>% 
  strsplit(split = "\n")



title_17 <- pdf_17[18:101] # need to check pdf (overlap)


titledm_17 <- data.frame() # as data frame

for (i in 1:length(title_17)) {
  print(i)
  titlelines_17 <- data.frame(names = title_17[[i]])
  titledm_17 <- bind_rows(titledm_17, titlelines_17)
} 



titledm_17$names <- gsub("2,4-D" , "twofourd" , titledm_17$names)



title_tokens_17 <- titledm_17 %>%
  unnest_tokens(words, names)




authors_17 <- pdf_17[102:107]

authorsdm_17 <- data.frame()

for (i in 1:length(authors_17)) {
  print(i)
  authorslines_17 <- data.frame(names = authors_17[[i]])
  authorsdm_17 <- bind_rows(authorsdm_17, authorslines_17)
} 

#tokerization
authors_tokens_17 <- authorsdm_17 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")



titles_tokens_17<- anti_join(title_tokens_17, authors_tokens_17, by = "words")



rm_author_17 <- c(1:12) 
rm_authors_number_17 <-c()
for (i in 1:length(rm_author_17)) {
  print(i)
  rm_authors_numbers_17 <- c(paste0(authors_tokens_17$words, i))
  rm_authors_number_17 <- c(rm_authors_number_17, rm_authors_numbers_17)
}

rm_authors_17 <- data.frame(rm_authors_number_17) 
rm_authors_17 <- rename(rm_authors_17, words = rm_authors_number_17) 
rm_authors_17$words <- as.character(rm_authors_17$words)



title_tokens_17 <- anti_join(title_tokens_17, rm_authors_17, by = "words") 
#title_tokens_17 <- anti_join(title_tokens_17, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_17 <- anti_join(title_tokens_17, stopwords_tokens, by = "words") 
title_tokens_17 <- anti_join(title_tokens_17, authors_tokens_17, by = "words") 




title_source_17 <- VectorSource(title_tokens_17$words)
title_corpus_17 <- VCorpus(title_source_17)
title_corpus_17 <- clean_corpus(title_corpus_17)



title_dtm_17 <- TermDocumentMatrix(title_corpus_17)
title_matrix_17 <- as.matrix(title_dtm_17)
title_v_17 <- sort(rowSums(title_matrix_17), decreasing=TRUE)
title_dt_17 <- data.frame(word = names(title_v_17),freq=title_v_17)


title_dt_17$word <- gsub("twofourd" , "2,4-D" , title_dt_17$word)


words17 <- title_dt_17  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1) %>% 
  mutate(year = "2017") %>% 
  anti_join(stop_wssaprogram_words)
```

```{r eval=FALSE, include=FALSE}   
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_17$word, freq = title_dt_17$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```




# 2018

```{r}
pdf_18 <- pdf_text("nc2018.pdf") %>% 
  strsplit(split = "\n")



title_18 <- pdf_18[16:107] # need to check pdf (overlap)



titledm_18 <- data.frame() # as data frame

for (i in 1:length(title_18)) {
  print(i)
  titlelines_18 <- data.frame(names = title_18[[i]])
  titledm_18 <- bind_rows(titledm_18, titlelines_18)
} 



titledm_18$names <- gsub("2,4-D" , "twofourd" , titledm_18$names)




title_tokens_18 <- titledm_18 %>%
  unnest_tokens(words, names)




authors_18 <- pdf_18[108:112]

authorsdm_18 <- data.frame()

for (i in 1:length(authors_18)) {
  print(i)
  authorslines_18 <- data.frame(names = authors_18[[i]])
  authorsdm_18 <- bind_rows(authorsdm_18, authorslines_18)
} 

#tokerization
authors_tokens_18 <- authorsdm_18 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed")




titles_tokens_18 <- anti_join(title_tokens_18, authors_tokens_18, by = "words")




rm_author_18 <- c(1:12) 
rm_authors_number_18 <-c()
for (i in 1:length(rm_author_18)) {
  print(i)
  rm_authors_numbers_18 <- c(paste0(authors_tokens_18$words, i))
  rm_authors_number_18 <- c(rm_authors_number_18, rm_authors_numbers_18)
}

rm_authors_18 <- data.frame(rm_authors_number_18) 
rm_authors_18 <- rename(rm_authors_18, words = rm_authors_number_18) 
rm_authors_18$words <- as.character(rm_authors_18$words)




title_tokens_18 <- anti_join(title_tokens_18, rm_authors_18, by = "words") 
#title_tokens_18 <- anti_join(title_tokens_18, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_18 <- anti_join(title_tokens_18, stopwords_tokens, by = "words") 
title_tokens_18 <- anti_join(title_tokens_18, authors_tokens_18, by = "words") 




title_source_18 <- VectorSource(title_tokens_18$words)
title_corpus_18 <- VCorpus(title_source_18)
title_corpus_18 <- clean_corpus(title_corpus_18)



title_dtm_18 <- TermDocumentMatrix(title_corpus_18)
title_matrix_18 <- as.matrix(title_dtm_18)
title_v_18 <- sort(rowSums(title_matrix_18), decreasing=TRUE)
title_dt_18 <- data.frame(word = names(title_v_18),freq=title_v_18)




title_dt_18$word <- gsub("twofourd" , "2,4-D" , title_dt_18$word)


words18 <- title_dt_18  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1)  %>% 
  mutate(year = "2018") %>% 
  anti_join(stop_wssaprogram_words)
```

```{r eval=FALSE, include=FALSE}  
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_18$word, freq = title_dt_18$freq, min.freq=1, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```




# 2019

```{r}
pdf_19 <- pdf_text("nc2019.pdf") %>% 
  strsplit(split = "\n")



title_19 <- pdf_19[2:223] # need to check pdf (overlap)



titledm_19 <- data.frame() # as data frame

for (i in 1:length(title_19)) {
  print(i)
  titlelines_19 <- data.frame(names = title_19[[i]])
  titledm_19 <- bind_rows(titledm_19, titlelines_19)
} 




titledm_19$names <- gsub("2,4-D" , "twofourd" , titledm_19$names)




title_tokens_19 <- titledm_19 %>%
  unnest_tokens(words, names)



authors_19 <- pdf_18[108:112]

authorsdm_19 <- data.frame()

for (i in 1:length(authors_19)) {
  print(i)
  authorslines_19 <- data.frame(names = authors_19[[i]])
  authorsdm_19 <- bind_rows(authorsdm_19, authorslines_19)
} 

#tokerization
authors_tokens_19 <- authorsdm_19 %>%
  unnest_tokens(words, names) %>% 
  filter(words != "weed" & words != "palmer")



titles_tokens_19 <- anti_join(title_tokens_19, authors_tokens_19, by = "words")




rm_author_19 <- c(224:233) 
rm_authors_number_19 <-c()
for (i in 1:length(rm_author_19)) {
  print(i)
  rm_authors_numbers_19 <- c(paste0(authors_tokens_19$words, i))
  rm_authors_number_19 <- c(rm_authors_number_19, rm_authors_numbers_19)
}

rm_authors_19 <- data.frame(rm_authors_number_19) 
rm_authors_19 <- rename(rm_authors_19, words = rm_authors_number_19) 
rm_authors_19$words <- as.character(rm_authors_19$words)



title_tokens_19 <- anti_join(title_tokens_19, rm_authors_19, by = "words") 
#title_tokens_19 <- anti_join(title_tokens_19, stop_wssaprogram_words_tokens, by = "words") 
title_tokens_19 <- anti_join(title_tokens_19, stopwords_tokens, by = "words") 
title_tokens_19 <- anti_join(title_tokens_19, authors_tokens_19, by = "words") 



title_source_19 <- VectorSource(title_tokens_19$words)
title_corpus_19 <- VCorpus(title_source_19)
title_corpus_19 <- clean_corpus(title_corpus_19)


title_dtm_19 <- TermDocumentMatrix(title_corpus_19)
title_matrix_19 <- as.matrix(title_dtm_19)
title_v_19 <- sort(rowSums(title_matrix_19), decreasing=TRUE)
title_dt_19 <- data.frame(word = names(title_v_19),freq=title_v_19)



title_dt_19$word <- gsub("twofourd" , "2,4-D" , title_dt_19$word)



words19 <- title_dt_19  %>% 
  select(word, freq) %>% 
  #group_by(word) %>% 
  add_tally(freq, name="nn") %>% 
  mutate(Perc=(freq/nn)*100) %>% 
  mutate_at(4, round, 1)  %>% 
  mutate(year = "2019") %>% 
  anti_join(stop_wssaprogram_words)
```





```{r message = FALSE, warning=FALSE, eval=FALSE, include=FALSE} 
pal <- brewer.pal(8,"Dark2") #selecting the color palette

set.seed(1234)
wordcloud(words = title_dt_19$word, freq = title_dt_19$freq, min.freq=2, scale=c(4,.1),
           random.order=FALSE, rot.per=0.35, colors=pal)
```




```{r}
Data <- bind_rows(words01, words02, words03, words04, words05, words06, words07, words08, words09, words10, words11, words12, words13, words14, words15, words16, words17, words18, words19)
#Data$year <- as.numeric(Data$year)
#data <- Data %>% 
#  filter( word == "palmer" | word == "glyphosate" |  word == "dicamba" | word == "resistant")
```




```{r  eval=FALSE}
Data %>% 
    ggplot(aes(y=freq, label = word, size = word, color = word)) + 
      #geom_bar(stat ="identity", show.legend = FALSE) + 
      geom_text_wordcloud() +
#      scale_size_area(max_size = 20) +
      facet_wrap(~year) +
      ggsave("cloud.png", height=12, width = 12)
```

```{r eval=FALSE}
Data %>% 
  #filter(year == "2005" | year == "2011") %>% 
ggplot(aes(freq/nn, fill = year)) +
  geom_histogram(show.legend = FALSE) +
  #xlim(NA, 0.0009) +
  facet_wrap(~year, ncol=4, scales = "free_y") +
  ggsave("figure.png")
```

```{r}
freq_by_rank <- Data %>% 
  group_by(year) %>% 
  mutate(rank = row_number())
```


```{r}
freq_by_rank <- freq_by_rank %>% 
  mutate(highlight = ifelse(word %in% c("glufosinate", "imazethapyr", "foramsulfuron", "clopyralid", "mesotrione", "2,4-D", "dicamba", "glyphosate", "metolachlor",
                                            "atrazine"), TRUE, FALSE),
       variable_col = if_else(highlight == TRUE, word, "NA"))
```

```{r}
freq_by_rank <- freq_by_rank %>% 
  mutate(highlight = ifelse(word %in% c("palmer", "kochia", "horseweed", "grass", "nightshade", "waterhemp", "velvetleaf", "ragweed",
                                            "foxtail"), TRUE, FALSE),
       variable_col = if_else(highlight == TRUE, word, "NA"))
```

```{r}
#Set theme
library(extrafont)
#font_family <- 'Arial' 
background <- "#1D1D1D"
text_colour <- "white"
axis_colour <- "white"
plot_colour <- "black"
theme_style <- theme(#text = element_text(family = font_family),
                  rect = element_rect(fill = background),
                  plot.background = element_rect(fill = background, color = NA),
                  plot.title = element_text(face = 'bold', size = 50, colour = text_colour),
                  plot.subtitle = element_text(size = 30, colour = text_colour),
                  plot.caption = element_text(size = 20, colour = text_colour),
                  panel.background = element_rect(fill = background, color = NA),
                  panel.border = element_blank(),
                  panel.grid.major.y = element_blank(),
                  panel.grid.major.x = element_blank(),
                  panel.grid.minor.x = element_blank(),
                  plot.margin = unit(c(3, 0.5, 0.5, 0.5), "cm"), # top, left, bottom, right
                  axis.title.y = element_text(face = 'bold', size = 40, 
                                              colour = text_colour),
                  axis.title.x = element_blank(),
                  axis.text.x.bottom = element_text(size = 45, colour= axis_colour, 
                                                    vjust = 17),
                  axis.text.x.top = element_text(size = 45, colour= axis_colour, 
                                                    vjust = -14),
                  axis.text.y = element_text(size = 30, colour = text_colour),
                  axis.ticks = element_blank(),
                  axis.line = element_blank(),
                  legend.text = element_text(size = 20, colour= text_colour),
                  legend.title = element_text(size = 25, colour= text_colour),
                  legend.position="none") 


theme_set(theme_classic() + theme_style)

#Set colour palette
cols <- c("#FE5F55", "#4281A4", "#48A9A6", "#D4B483", "#E4DFDA", "#C1666B", "#39393A")
```
"2,4-D", "atrazine", "clopyralid", "dicamba", "foramsulfuron",  "glufosinate", "glyphosate", "imazethapyr",  "mesotrione", "metolachlor", " NA
                                            
                                           
"foxtail", "horseweed", "Kochia",  NA,  "palmer", "ragweed", "velvetleaf", "waterhemp"
                                                                  
               


```{r}
#Plot data
freq_by_rank_1 <- freq_by_rank %>% 
  filter(rank < 101) %>% 
  mutate(year = as.double(year))

ggplot(freq_by_rank_1, aes(x = year, y = rank, group = word)) +
  geom_line(data = freq_by_rank_1 %>% filter(variable_col == "NA"),
                                      color = "#39393A", size = 4) +
  geom_point(data = freq_by_rank_1 %>% filter(variable_col == "NA"),
                                      color = "#39393A", size = 10) +
  geom_line(data = freq_by_rank_1 %>% filter(variable_col != "NA"),
                                       aes(color = variable_col), size = 4) +
  geom_point(data = freq_by_rank_1 %>% filter(variable_col != "NA"),
                                       aes(color = variable_col), size = 10) +
  scale_y_reverse(breaks = 100:1) +
  scale_x_continuous(breaks = seq(2001, 2019, 2), limits= c(2000, 2020), 
                     expand = c(.05, .05), sec.axis = dup_axis()) +
  geom_text(data = freq_by_rank_1 %>%  filter(year == "2001"),
            aes(label = word, x = 2000.8, color = variable_col),
            hjust = "right",
            fontface = "bold",
            size = 11) +
  geom_text(data = freq_by_rank_1 %>%  filter(year == "2019"),
            aes(label = word, x = 2019.2, color = variable_col),
            hjust = "left",
            fontface = "bold",
            size = 11) +
  coord_cartesian(ylim = c(101,1)) +
  scale_color_manual(values = c("#FE5F55", "#FFFF60", "#E1DB8F", "#D0FFFF", "#FF78FF", 
  "#4281A4", "#48A9A6", "#D4B483", "#E4DFDA", # 
                                "#C1666B", "#39393A")) +
#   scale_color_manual(values = c("#F2D9F3", "#00E5E5", "#DEB887", "#FAC8C8", "#39393A", 
#                                 "#FA9664", "#FF4040",    
#                               "#48DE7A", "#F5F5DC", "#FAFA00")) +
#scale_y_reverse(breaks = 1:nrow(NY_kids)) +
  labs(title = "NCWSS Meeting text analysis of title and abstracts from 2001 through 2019",
       subtitle = "Ranking the top 100 words of each NCWSS proceeding meetings with selected highlighted weeds", y= "Rank",
       caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS") 

#Export plot
ggsave("word_rank_herb.pdf", width = 40, height = 60, dpi=300, limitsize = FALSE)
```





```{r eval=FALSE}
freq_by_rank %>% 
  mutate(year = as.factor(year)) %>% 
  ggplot(aes(rank, `term frequency`, color = year)) + 
  geom_line(size = 1.1, alpha = 0.8, show.legend = FALSE) + 
  scale_x_log10() +
  scale_y_log10()
```

```{r eval=FALSE}
rank_subset <- freq_by_rank %>% 
  filter(rank < 500,
         rank > 10)

lm(log10(`term frequency`) ~ log10(rank), data = rank_subset)
```

```{r eval=FALSE}
freq_by_rank %>%
  mutate(year = as.factor(year)) %>% 
  ggplot(aes(rank, `term frequency`, color = year)) + 
  geom_abline(intercept = -1.0868, slope = -0.8151, color = "gray50", linetype = 2) +
  geom_line(size = 1.1, alpha = 0.8, show.legend = FALSE) + 
  scale_x_log10() +
  scale_y_log10()
```

```{r eval=FALSE}
year_words <- Data %>%
  filter
  bind_tf_idf(word, year, freq)

year_words
```

```{r eval=FALSE}
year_words %>%
  select(-nn) %>%
  arrange(desc(tf_idf))
```



```{r eval=FALSE}
year_words %>%
  arrange(desc(tf_idf)) %>%
  mutate(word = factor(word, levels = rev(unique(word)))) %>% 
  group_by(year) %>% 
  top_n(15) %>% 
  ungroup() %>%
  ggplot(aes(reorder(word, tf_idf), tf_idf, fill = year)) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = "tf-idf") +
  facet_wrap(~year, ncol = 4, scales = "free") +
  coord_flip() +
  ggsave("Figure 2.png", width = 12, height=12)
```


```{r eval=FALSE}
data <- rbind(words02, words03, words04, words05)
year_words <- data %>%
  bind_tf_idf(word, year, freq)

year_words
```

```{r eval=FALSE}
year_words %>%
  select(-nn) %>%
  arrange(desc(tf_idf))
```



```{r eval=FALSE}
year_words %>%
  arrange(desc(tf_idf)) %>%
  mutate(word = factor(word, levels = rev(unique(word)))) %>% 
  group_by(year) %>% 
  top_n(15) %>% 
  ungroup() %>%
  ggplot(aes(reorder(word, tf_idf), tf_idf, fill = year)) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = "tf-idf") +
  facet_wrap(~year, ncol = 4, scales = "free") +
  coord_flip() +
  ggsave("Figure 2.png", width = 12, height=12)
```